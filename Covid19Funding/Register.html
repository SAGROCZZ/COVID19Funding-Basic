<!DOCTYPE html>
<html>
<head>
    <title></title>
	<meta charset="utf-8" />
    <link href="css/bootstrap.min.css" rel="stylesheet" />
</head>
<body>

    <script>
        window.onload = function () {
            if (typeof web3 == 'undefined') {
                document.getElementById("metamask").innerHTML = "Please Install Metamask to run this dApp";
            }
           
           
        }

        function register() {
            try {
              
                var abi = [
{
    "inputs": [
        {
            "internalType": "address",
            "name": "_address",
            "type": "address"
        },
        {
            "internalType": "string",
            "name": "_orgName",
            "type": "string"
        },
        {
            "internalType": "string",
            "name": "_orgCountry",
            "type": "string"
        },
        {
            "internalType": "string",
            "name": "_fundingPurpose",
            "type": "string"
        },
        {
            "internalType": "uint256",
            "name": "_amtNeeded",
            "type": "uint256"
        }
    ],
    "name": "addOrg",
    "outputs": [],
    "stateMutability": "nonpayable",
    "type": "function"
},
{
    "inputs": [
        {
            "internalType": "address",
            "name": "_toOrg",
            "type": "address"
        },
        {
            "internalType": "uint256",
            "name": "_amount",
            "type": "uint256"
        }
    ],
    "name": "donateFunds",
    "outputs": [],
    "stateMutability": "payable",
    "type": "function"
},
{
    "inputs": [],
    "stateMutability": "nonpayable",
    "type": "constructor"
},
{
    "anonymous": false,
    "inputs": [
        {
            "indexed": false,
            "internalType": "address",
            "name": "",
            "type": "address"
        },
        {
            "indexed": false,
            "internalType": "uint256",
            "name": "",
            "type": "uint256"
        }
    ],
    "name": "donate",
    "type": "event"
},
{
    "inputs": [
        {
            "internalType": "address",
            "name": "_toOrg",
            "type": "address"
        }
    ],
    "name": "withdrawFunds",
    "outputs": [],
    "stateMutability": "nonpayable",
    "type": "function"
},
{
    "inputs": [],
    "name": "getBalance",
    "outputs": [
        {
            "internalType": "uint256",
            "name": "",
            "type": "uint256"
        }
    ],
    "stateMutability": "view",
    "type": "function"
},
{
    "inputs": [
        {
            "internalType": "address",
            "name": "_address",
            "type": "address"
        }
    ],
    "name": "getOrg",
    "outputs": [
        {
            "internalType": "string",
            "name": "",
            "type": "string"
        },
        {
            "internalType": "string",
            "name": "",
            "type": "string"
        },
        {
            "internalType": "string",
            "name": "",
            "type": "string"
        },
        {
            "internalType": "uint256",
            "name": "",
            "type": "uint256"
        },
        {
            "internalType": "uint256",
            "name": "",
            "type": "uint256"
        }
    ],
    "stateMutability": "view",
    "type": "function"
},
{
    "inputs": [],
    "name": "getOrgs",
    "outputs": [
        {
            "internalType": "address[]",
            "name": "",
            "type": "address[]"
        }
    ],
    "stateMutability": "view",
    "type": "function"
},
{
    "inputs": [
        {
            "internalType": "uint256",
            "name": "",
            "type": "uint256"
        }
    ],
    "name": "orgAccts",
    "outputs": [
        {
            "internalType": "address",
            "name": "",
            "type": "address"
        }
    ],
    "stateMutability": "view",
    "type": "function"
}
                ]
                var contractaddress = "0x4f6ae0b2e30d72bc5d164adafd734a7d9a72d8ab";
                var myabi = web3.eth.contract(abi);
                var myFunction = myabi.at(contractaddress);

               

                var xaddress = document.getElementById("xaddress").value;
                var xname = document.getElementById("xname").value;
                var xcountry = document.getElementById("xcountry").value;
                var xpurpose = document.getElementById("xpurpose").value;
                var xrequested = document.getElementById("xrequested").value;

                myFunction.addOrg.sendTransaction(xaddress, xname, xcountry, xpurpose, xrequested, { from: web3.eth.accounts[0], gas: 400000 },
                    function (err, result) {
                        if (err) {
                            document.getElementById("metamask").innerHTML = err;
                        } else {
                            document.getElementById("metamask").innerHTML = result;
                        }
                    });

            } catch (err) {
                document.getElementById("metamask").innerHTML = err;
            }
        }

    </script>

    <div id="metamask"></div>

    <div class="row" style="margin-left:10px">
        <div class="col-md-6">
            <h1 class="p-2">
                Covid-19 Funding
            </h1>

        </div>
        <div class="col-md-6">
            <ul class="nav nav-tabs">
                <li class="p-4">
                    <a class="btn btn-info" href="Index.html">Home</a>
                </li>
                <li class="p-4">
                    <a class="btn btn-info" href="Register.html">New Request</a>
                </li>
            </ul>
        </div>

        <div class="col-md-12 text-center p-4">
            <h3>Register a new Covid-19 Beneficiary Organisation</h3>
        </div>

        <div class="col-md-3 p-2">
            Ethereum Address
      </div>
        <div class="col-md-6 p-2">
            <input id="xaddress" class="form-control" type="text" />
        </div>
        <div class="col-m-3 p-2"></div>

        <div class="col-md-3 p-2">
            Organisation Name
        </div>
        <div class="col-md-6 p-2">
            <input id="xname" class="form-control" type="text" />
        </div>
        <div class="col-m-3 p-2"></div>

        <div class="col-md-3 p-2">
            Country
        </div>
        <div class="col-md-6 p-2">
            <input id="xcountry" class="form-control" type="text" />
        </div>
        <div class="col-m-3 p-2"></div>

        <div class="col-md-3 p-2">
            Funding Purpose
        </div>
        <div class="col-md-6 p-2">
            <input id="xpurpose" class="form-control" type="text" />
        </div>
        <div class="col-m-3 p-2"></div>

        <div class="col-md-3 p-2">
            Amount Requested in Eth
        </div>
        <div class="col-md-6 p-2">
            <input id="xrequested" class="form-control" type="text" />
        </div>
        <div class="col-m-3 p-2"></div>

        <div class="col-md-3 p-2">
         
        </div>
        <div class="col-md-6 p-2">
            <input id="Button1" type="button" onclick="register()" class="btn btn-lg btn-info" value="Register" />
          
        </div>
        <div class="col-m-3 p-2"></div>

    </div>
</body>
</html>
